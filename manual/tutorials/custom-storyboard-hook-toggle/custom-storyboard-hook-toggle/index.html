<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../favicon.ico">
        
        <title>Creating a Custom Storyboard Hook For UI.Toggle - Canvas Flow</title>
        <link href="../../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../../css/highlight.css">
        <link href="../../../../css/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../../js/highlight.pack.js"></script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-57773606-3', 'canvasflow.xyz');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../../..">Canvas Flow</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../../../..">Home</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Manual <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../contents/">Contents</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Canvas Controllers</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../canvas-controllers/introduction/">Introduction</a>
</li>
            
<li >
    <a href="../../../canvas-controllers/creating-a-canvas-controller/">Creating A Canvas Controller</a>
</li>
            
<li >
    <a href="../../../canvas-controllers/canvas-controller-scenes/">Canvas Controller Scenes</a>
</li>
            
<li >
    <a href="../../../canvas-controllers/presentation-and-dismissal/">Presentation & Dismissal</a>
</li>
            
<li >
    <a href="../../../canvas-controllers/canvas-controller-life-cycle/">Canvas Controller Life Cycle</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Storyboards</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../storyboards/introduction/">Introduction</a>
</li>
            
<li >
    <a href="../../../storyboards/creating-a-storyboard/">Creating A Storyboard</a>
</li>
            
<li >
    <a href="../../../storyboards/storyboard-nodes/">Storyboard Nodes</a>
</li>
            
<li >
    <a href="../../../storyboards/storyboard-transitions/">Storyboard Transitions</a>
</li>
            
<li >
    <a href="../../../storyboards/presenting-a-storyboard/">Presenting A Storyboard</a>
</li>
            
<li >
    <a href="../../../storyboards/custom-storyboard-hooks/">Custom Storyboard Hooks</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Transition Animators</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../transition-animators/introduction/">Introduction</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Default Transition Animators</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../transition-animators/default-transition-animators/transition-animator-default/">Default Transition Animator</a>
</li>
            
<li >
    <a href="../../../transition-animators/default-transition-animators/transition-animator-fade-to-color/">Fade To Color Transition Animator</a>
</li>
            
<li >
    <a href="../../../transition-animators/default-transition-animators/transition-animator-slide/">Slide Transition Animator</a>
</li>
            
<li >
    <a href="../../../transition-animators/default-transition-animators/transition-animator-scale/">Scale Transition Animator</a>
</li>
            
<li >
    <a href="../../../transition-animators/default-transition-animators/transition-animator-scale-and-fade/">Scale And Fade Background Transition Animator</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../../../transition-animators/using-a-transition-animator/">Using A Transition Animator</a>
</li>
            
<li >
    <a href="../../../transition-animators/custom-transition-animators/">Custom Transition Animators</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Miscellaneous</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../miscellaneous/preferences/">Preferences</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Tutorials</a>
    <ul class="dropdown-menu">
            
<li class="active">
    <a href="./">Creating a Custom Storyboard Hook For UI.Toggle</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Scripting Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../../scripting-reference/contents/">Contents</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Canvas Controllers</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../scripting-reference/canvas-controller/CanvasController/">CanvasController</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/canvas-controller/CanvasControllerExtensions/">CanvasController Extensions</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/canvas-controller/CanvasControllerPresentationMode/">CanvasControllerPresentationMode</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/canvas-controller/CanvasControllerTransitionContext/">CanvasControllerTransitionContext</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/canvas-controller/CanvasControllerTransitioningAnimator/">CanvasControllerTransitioningAnimator</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/canvas-controller/ICanvasControllerTransitioningAnimator/">ICanvasControllerTransitioningAnimator</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/canvas-controller/ICanvasControllerTransitioningAnimatorVendor/">ICanvasControllerTransitioningAnimatorVendor</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Storyboards</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../scripting-reference/storyboards/Storyboard/">Storyboard</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/storyboards/StoryboardData/">StoryboardData</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/storyboards/hooks/StoryboardHook/">StoryboardHook</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/storyboards/StoryboardTransition/">StoryboardTransition</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/storyboards/StoryboardTransitionDirection/">StoryboardTransitionDirection</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/storyboards/StoryboardTransitionEvent/">StoryboardTransitionEvent</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Extensions And Convenience</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../scripting-reference/routine/Routine/">Routine</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/extensions/DynamicObjectExtensions/">DynamicObjectExtensions</a>
</li>
            
<li >
    <a href="../../../../scripting-reference/extensions/RectTransformExtensions/">RectTransformExtensions</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../../../miscellaneous/preferences/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../../../scripting-reference/contents/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#creating-a-custom-storyboard-hook-for-uitoggle">Creating a Custom Storyboard Hook For UI.Toggle</a></li>
            <li><a href="#create-a-new-storyboard-hook">Create a new storyboard hook</a></li>
            <li><a href="#specify-the-auto-add-type">Specify the Auto-Add type</a></li>
            <li><a href="#implement-the-reset-connect-methods">Implement the Reset &amp; Connect methods</a></li>
            <li><a href="#use-it">Use it</a></li>
            <li><a href="#source">Source</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="creating-a-custom-storyboard-hook-for-uitoggle">Creating a Custom Storyboard Hook For UI.Toggle</h1>
<p>In this tutorial, we will add support for Toggles in storyboards, which will allow us to use a toggle in a storyboard to trigger a transition to another canvas controller. This is done by creating a <a href="../../../storyboards/custom-storyboard-hooks/">Custom Storyboard Hook</a> and should hopefully serve as a good example for creating custom storyboard hooks for other components, such as custom button types, too.</p>
<p>To illustrate, the transition shown below was configured in a storyboard and is being triggered by a <code>UI.Toggle</code> being switched on.</p>
<div id="centered">
    <video controls controlsList="nodownload" width="600px" name="Toggle Example" src="../vid/storyboard-toggle.mov" style="margin-bottom:0px"></video>
    <br>
</div>

<hr />
<h2 id="create-a-new-storyboard-hook">Create a new storyboard hook</h2>
<p>Begin by creating a new storyboard hook script. This is done by selecting <em>Create/Canvas Flow/Storyboard Hook</em> in Unity's Create menu, found in the menu bar at <em>Assets/Create</em> or by right-clicking in the project window.</p>
<p>This will create a new script at the specified location, with three methods for us to implement.</p>
<h2 id="specify-the-auto-add-type">Specify the Auto-Add type</h2>
<p>Firstly, let's implement the <code>AutoAddComponentType</code> method. We want our hook to be automatically added to any Toggles in our UI, so we can return the Toggle type here, like so:</p>
<pre><code class="csharp">public override System.Type AutoAddComponentType
{
    get
    {
        return typeof(UnityEngine.UI.Toggle);
    }
}
</code></pre>

<h2 id="implement-the-reset-connect-methods">Implement the Reset &amp; Connect methods</h2>
<p>We now have two remaining methods left to implement - <code>Connect</code> and <code>Reset</code>. In our <code>Connect</code> method, we need to connect the provided <code>invokeTransition</code> action to our toggle so that when the toggle is switched on, the storyboard transition is triggered. Therefore, we first need a reference to our Toggle component. We can obtain this reference in the <code>Reset</code> method and store it in a public field on our component (so it gets serialized by Unity), like so:</p>
<pre><code class="csharp">public UnityEngine.UI.Toggle toggle;

protected override void Reset()
{
    // Always call base.Reset() when overriding Reset() in a custom hook.
    base.Reset();

    toggle = GetComponent&lt;UnityEngine.UI.Toggle&gt;();
}
</code></pre>

<p>Great, so now let's write the code to attach the transition callback to the toggle in the <code>Connect</code> method.</p>
<pre><code class="csharp">public override void Connect(System.Action&lt;StoryboardHook&gt; invokeTransition)
{
    toggle.onValueChanged.AddListener((isOn) =&gt;
    {
        if (isOn)
        {
            invokeTransition(this);
        }
    });
}
</code></pre>

<p>Here we attach a callback to our toggle's <code>onValueChanged</code> event. Notice here how we are observing the toggle's <code>isOn</code> property. If the toggle has been switched on, we will invoke the storyboard transition. Otherwise, if it has been switched off, we will ignore it.</p>
<p>And that's it!</p>
<h2 id="use-it">Use it</h2>
<p>Now, if we add a toggle element in a canvas controller, like so…</p>
<p><img alt="" src="../img/toggle.png" /></p>
<p>… the toggle is available to use in a storyboard!</p>
<p><img alt="" src="../img/toggle-storyboard.png" /></p>
<p>Which, when connected, causes our transition to be invoked when the toggle is switched on but not off, like so:</p>
<div id="centered">
    <video controls controlsList="nodownload" width="600px" name="Toggle Example" src="../vid/storyboard-toggle.mov" style="margin-bottom:0px"></video>
    <br>
</div>

<blockquote>
<p>The above video uses the built-in Scale And Fade animator, as well as the <code>KeepPresenterVisible</code> setting on the transition.</p>
</blockquote>
<p>And that's all that is required to implement a custom hook for UI.Toggle!</p>
<h2 id="source">Source</h2>
<p>For reference, the entire storyboard hook file we just created looks like this:</p>
<pre><code class="c#">using P7.CanvasFlow;

public class ToggleStoryboardHook : StoryboardHook
{
    public UnityEngine.UI.Toggle toggle;

    protected override void Reset()
    {
        // Always call base.Reset() when overriding Reset() in a custom hook.
        base.Reset();

        toggle = GetComponent&lt;UnityEngine.UI.Toggle&gt;();
    }

    public override System.Type AutoAddComponentType
    {
        get
        {
            return typeof(UnityEngine.UI.Toggle);
        }
    }

    public override void Connect(System.Action&lt;StoryboardHook&gt; invokeTransition)
    {
        toggle.onValueChanged.AddListener((isOn) =&gt;
        {
            if (isOn)
            {
                invokeTransition(this);
            }
        });
    }
}
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>© 2018 <a href="https://www.pelican7.com/" target="_blank">Pelican 7 LTD</a>. All rights reserved.</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../../../..';</script>
        <script src="../../../../js/base.js"></script>
        <script src="../../../../search/require.js"></script>
        <script src="../../../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
